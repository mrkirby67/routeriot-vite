#!/bin/bash
echo "ğŸ”§ Backing up current monolith..."
mv modules/speedBumpManager.js modules/speedBumpManager_FULL.js

echo "ğŸ“ Creating modular folder..."
mkdir -p modules/speedBump

echo "ğŸ§± Creating module files..."
touch modules/speedBump/{index.js,core.js,comms.js,interactions.js,timers.js,reversals.js}

echo "ğŸ” Updating imports..."
grep -rl "speedBumpManager.js" ./components ./modules ./player.js ./control.js | while read -r file; do
  sed -i '' 's#speedBumpManager.js#speedBump/index.js#g' "$file"
done

echo "âš™ï¸ Running codex refresh..."
npx codex --reindex || echo "âš ï¸ Codex refresh skipped (offline sandbox)."

echo "âœ… Split complete!"
