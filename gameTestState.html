<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ”¥ Firestore GameState Live Monitor</title>
  <style>
    body {
      font-family: monospace;
      background-color: #0d0d0d;
      color: #00ff66;
      padding: 20px;
      line-height: 1.5;
    }
    h1, h2 {
      color: #0ff;
    }
    pre {
      background: #111;
      padding: 12px;
      border-radius: 8px;
      overflow-x: auto;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .error {
      color: #ff5555;
    }
    .status {
      margin-top: 10px;
      font-style: italic;
    }
  </style>
</head>
<body>
  <h1>ğŸ“¡ Firestore GameState Debugger</h1>
  <h2>Collection: <code>game</code> â†’ Document: <code>gameState</code></h2>
  <pre id="output">Connecting...</pre>
  <div id="status" class="status"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, doc, onSnapshot } 
      from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // ğŸš¨ SECURITY NOTE ğŸš¨
    // Do NOT commit your actual API key here â€” use placeholders or a local-only file.
    // Paste your values temporarily *only for local debugging*.
    const firebaseConfig = {
      apiKey: "REDACTED_FOR_SECURITY",  // ğŸ”’ <â€” Replace with your local key ONLY for testing
      authDomain: "routeriotgame.firebaseapp.com",
      projectId: "routeriotgame",
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const output = document.getElementById("output");
    const status = document.getElementById("status");
    const ref = doc(db, "game", "gameState");

    try {
      onSnapshot(ref, (snap) => {
        if (!snap.exists()) {
          output.textContent = "âŒ No document found at game/gameState";
          status.textContent = "Listening for updates...";
          return;
        }

        const data = snap.data();
        output.textContent = JSON.stringify(data, null, 2);

        const st = data.status || "unknown";
        status.textContent = `Status: ${st.toUpperCase()} â€¢ Updated: ${new Date().toLocaleTimeString()}`;
        console.log("ğŸ”¥ Live GameState Snapshot:", data);
      });
    } catch (err) {
      output.textContent = "âš ï¸ Error connecting to Firestore:\n" + err.message;
      output.classList.add("error");
      console.error("ğŸ”¥ Firestore connection error:", err);
    }
  </script>
</body>
</html>